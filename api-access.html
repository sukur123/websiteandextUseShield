<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>API Access - UseShield</title>
    <link rel="stylesheet" href="shared.css" />
    <style>
      * { box-sizing: border-box; margin: 0; padding: 0; }
      body { 
        font-family: var(--font-family); 
        background: var(--color-bg);
        min-height: 100vh;
        color: var(--color-text);
      }
      .container { max-width: 900px; margin: 0 auto; padding: var(--space-xl); }
      
      .back-link { 
        display: inline-flex; 
        align-items: center;
        gap: var(--space-xs);
        color: var(--color-primary); 
        text-decoration: none; 
        margin-bottom: var(--space-md); 
        font-size: var(--text-sm);
        transition: var(--transition-fast);
      }
      .back-link:hover { opacity: 0.8; }
      
      header { margin-bottom: var(--space-2xl); }
      header h1 { font-size: var(--text-2xl); margin-bottom: var(--space-sm); display: flex; align-items: center; gap: var(--space-sm); }
      header p { color: var(--color-text-muted); }
      
      .tier-badge { display: inline-block; padding: var(--space-xs) var(--space-md); background: var(--gradient-primary); color: white; border-radius: var(--radius-full); font-size: var(--text-xs); font-weight: 600; margin-left: var(--space-md); }
      
      .upgrade-banner { background: var(--gradient-primary); color: white; border-radius: var(--radius-lg); padding: var(--space-xl); text-align: center; margin-bottom: var(--space-xl); }
      .upgrade-banner h2 { margin-bottom: var(--space-sm); display: flex; align-items: center; justify-content: center; gap: var(--space-sm); }
      .upgrade-banner p { opacity: 0.9; margin-bottom: var(--space-md); }
      .upgrade-banner .btn { background: white; color: var(--color-primary); }
      
      .section { background: var(--color-bg-secondary); border-radius: var(--radius-lg); padding: var(--space-xl); margin-bottom: var(--space-xl); box-shadow: var(--shadow-sm); }
      .section h2 { font-size: var(--text-lg); margin-bottom: var(--space-md); display: flex; align-items: center; gap: var(--space-sm); }
      
      .btn { appearance: none; border: 1px solid var(--color-border); background: var(--color-bg-secondary); border-radius: var(--radius-md); padding: var(--space-sm) var(--space-lg); font-size: var(--text-sm); cursor: pointer; transition: var(--transition-fast); display: inline-flex; align-items: center; gap: var(--space-xs); color: var(--color-text); }
      .btn:hover { background: var(--color-bg); }
      .btn-primary { background: var(--gradient-primary); color: white; border: none; }
      .btn-primary:hover { opacity: 0.9; }
      .btn-danger { color: var(--color-danger); border-color: var(--color-danger); }
      .btn-danger:hover { background: var(--color-danger-bg); }
      .btn-sm { padding: var(--space-xs) var(--space-md); font-size: var(--text-xs); }
      
      .api-key-box { 
        background: #1a1a2e; 
        border-radius: var(--radius-md); 
        padding: var(--space-md); 
        display: flex; 
        align-items: center; 
        gap: var(--space-md);
        margin-bottom: var(--space-md);
      }
      .api-key { 
        flex: 1; 
        font-family: 'Monaco', 'Menlo', monospace; 
        font-size: var(--text-sm); 
        color: #4ade80;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      .api-key.hidden { color: var(--color-text-muted); }
      
      .usage-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: var(--space-md); margin-bottom: var(--space-lg); }
      .usage-stat { text-align: center; padding: var(--space-md); background: var(--color-bg); border-radius: var(--radius-md); }
      .usage-stat-value { font-size: var(--text-2xl); font-weight: 700; color: var(--color-primary); }
      .usage-stat-label { font-size: var(--text-xs); color: var(--color-text-muted); margin-top: var(--space-xs); }
      
      .code-block { 
        background: #1a1a2e; 
        border-radius: var(--radius-md); 
        padding: var(--space-md); 
        overflow-x: auto;
        margin-bottom: var(--space-md);
      }
      .code-block code { 
        font-family: 'Monaco', 'Menlo', monospace; 
        font-size: var(--text-sm); 
        color: #e2e8f0;
        white-space: pre;
        display: block;
      }
      .code-block .comment { color: #64748b; }
      .code-block .string { color: #4ade80; }
      .code-block .keyword { color: #f472b6; }
      .code-block .function { color: #60a5fa; }
      
      .endpoint-list { border: 1px solid var(--color-border); border-radius: var(--radius-md); overflow: hidden; }
      .endpoint { padding: var(--space-md); border-bottom: 1px solid var(--color-border); }
      .endpoint:last-child { border-bottom: none; }
      .endpoint-method { display: inline-block; padding: var(--space-xs) var(--space-sm); border-radius: var(--radius-sm); font-size: var(--text-xs); font-weight: 600; margin-right: var(--space-sm); }
      .endpoint-method.post { background: var(--color-success-bg); color: var(--color-success); }
      .endpoint-method.get { background: var(--color-info-bg); color: var(--color-info); }
      .endpoint-path { font-family: monospace; font-size: var(--text-sm); }
      .endpoint-desc { font-size: var(--text-sm); color: var(--color-text-muted); margin-top: var(--space-sm); }
      
      .rate-limit-info { background: var(--color-warning-bg); border: 1px solid var(--color-warning); border-radius: var(--radius-md); padding: var(--space-md); }
      .rate-limit-info h4 { color: var(--color-warning); margin-bottom: var(--space-sm); display: flex; align-items: center; gap: var(--space-xs); }
      .rate-limit-info p { font-size: var(--text-sm); color: #92400e; }
      
      .key-list { margin-top: var(--space-md); }
      .key-item { display: flex; align-items: center; justify-content: space-between; padding: var(--space-md); background: var(--color-bg); border-radius: var(--radius-md); margin-bottom: var(--space-sm); }
      .key-name { font-weight: 600; }
      .key-created { font-size: var(--text-xs); color: var(--color-text-muted); }

      @media (prefers-color-scheme: dark) {
        body { background: var(--color-bg-dark); color: var(--color-text-dark); }
        .section { background: var(--color-bg-secondary-dark); }
        .usage-stat, .key-item { background: var(--color-bg-dark); }
        .btn { background: var(--color-bg-secondary-dark); color: var(--color-text-dark); border-color: var(--color-border-dark); }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <a href="#" class="back-link" id="backLink">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <line x1="19" y1="12" x2="5" y2="12"></line>
          <polyline points="12 19 5 12 12 5"></polyline>
        </svg>
        Back to extension
      </a>
      
      <header>
        <h1>
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"></path>
          </svg>
          API Access 
          <span class="tier-badge" id="tierBadge">Pro</span>
        </h1>
        <p>Integrate UseShield into your applications</p>
      </header>
      
      <div id="upgradeRequired" class="upgrade-banner" hidden>
        <h2>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
          </svg>
          API Access Requires Pro+ Tier
        </h2>
        <p>Upgrade to Pro Plus or Agency to access the API and integrate analyses into your workflow.</p>
        <button class="btn" onclick="window.location.href='subscription.html'">View Plans</button>
      </div>
      
      <div id="apiContent">
        <div class="section">
          <h2>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
            </svg>
            Your API Key
          </h2>
          
          <div class="api-key-box">
            <span class="api-key" id="apiKeyDisplay">••••••••••••••••••••••••••••••••</span>
            <button class="btn btn-sm" id="toggleKeyBtn">Show</button>
            <button class="btn btn-sm" id="copyKeyBtn">Copy</button>
          </div>
          
          <div style="display: flex; gap: var(--space-md);">
            <button class="btn btn-primary" id="generateKeyBtn">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
              Generate New Key
            </button>
            <button class="btn btn-danger" id="revokeKeyBtn">Revoke All Keys</button>
          </div>
          
          <div class="key-list" id="keyList"></div>
        </div>
        
        <div class="section">
          <h2>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
              <line x1="18" y1="20" x2="18" y2="10"></line>
              <line x1="12" y1="20" x2="12" y2="4"></line>
              <line x1="6" y1="20" x2="6" y2="14"></line>
            </svg>
            API Usage
          </h2>
          
          <div class="usage-stats">
            <div class="usage-stat">
              <div class="usage-stat-value" id="apiCallsToday">0</div>
              <div class="usage-stat-label">Calls Today</div>
            </div>
            <div class="usage-stat">
              <div class="usage-stat-value" id="apiCallsMonth">0</div>
              <div class="usage-stat-label">Calls This Month</div>
            </div>
            <div class="usage-stat">
              <div class="usage-stat-value" id="apiLimit">0</div>
              <div class="usage-stat-label">Monthly Limit</div>
            </div>
            <div class="usage-stat">
              <div class="usage-stat-value" id="avgResponseTime">0ms</div>
              <div class="usage-stat-label">Avg Response Time</div>
            </div>
          </div>
          
          <div class="rate-limit-info">
            <h4>
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                <line x1="12" y1="9" x2="12" y2="13"></line>
                <line x1="12" y1="17" x2="12.01" y2="17"></line>
              </svg>
              Rate Limits
            </h4>
            <p>Pro Plus: 200 requests/month, 10 requests/minute<br>
            Agency: 300 requests/month, 20 requests/minute</p>
          </div>
        </div>
        
        <div class="section">
          <h2>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
              <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
            </svg>
            API Endpoints
          </h2>
          
          <div class="endpoint-list">
            <div class="endpoint">
              <span class="endpoint-method post">POST</span>
              <span class="endpoint-path">/api/v1/analyze</span>
              <p class="endpoint-desc">Analyze text for money traps. Send the ToS text and receive risk analysis.</p>
            </div>
            <div class="endpoint">
              <span class="endpoint-method post">POST</span>
              <span class="endpoint-path">/api/v1/analyze-url</span>
              <p class="endpoint-desc">Analyze a URL directly. We'll fetch and analyze the page content.</p>
            </div>
            <div class="endpoint">
              <span class="endpoint-method get">GET</span>
              <span class="endpoint-path">/api/v1/history</span>
              <p class="endpoint-desc">Get your analysis history with filtering and pagination.</p>
            </div>
            <div class="endpoint">
              <span class="endpoint-method get">GET</span>
              <span class="endpoint-path">/api/v1/usage</span>
              <p class="endpoint-desc">Get your current API usage statistics.</p>
            </div>
          </div>
        </div>
        
        <div class="section">
          <h2>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
              <polyline points="16 18 22 12 16 6"></polyline>
              <polyline points="8 6 2 12 8 18"></polyline>
            </svg>
            Quick Start
          </h2>
          
          <h4 style="margin-bottom: var(--space-md); font-size: var(--text-sm);">cURL Example</h4>
          <div class="code-block">
            <code><span class="comment"># Analyze text for money traps</span>
curl -X POST https://api.useshield.net/v1/analyze \
  -H <span class="string">"Authorization: Bearer YOUR_API_KEY"</span> \
  -H <span class="string">"Content-Type: application/json"</span> \
  -d <span class="string">'{"text": "Your terms of service text here..."}'</span></code>
          </div>
          
          <h4 style="margin-bottom: var(--space-md); font-size: var(--text-sm);">JavaScript Example</h4>
          <div class="code-block">
            <code><span class="keyword">const</span> response = <span class="keyword">await</span> <span class="function">fetch</span>(<span class="string">'https://api.useshield.net/v1/analyze'</span>, {
  method: <span class="string">'POST'</span>,
  headers: {
    <span class="string">'Authorization'</span>: <span class="string">`Bearer ${API_KEY}`</span>,
    <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span>
  },
  body: <span class="function">JSON.stringify</span>({ text: tosText })
});

<span class="keyword">const</span> result = <span class="keyword">await</span> response.<span class="function">json</span>();
console.<span class="function">log</span>(result.riskScore, result.findings);</code>
          </div>
          
          <h4 style="margin-bottom: var(--space-md); font-size: var(--text-sm);">Response Format</h4>
          <div class="code-block">
            <code>{
  <span class="string">"success"</span>: <span class="keyword">true</span>,
  <span class="string">"data"</span>: {
    <span class="string">"riskScore"</span>: <span class="string">"7/10"</span>,
    <span class="string">"findings"</span>: [
      {
        <span class="string">"title"</span>: <span class="string">"Auto-Renewal Clause"</span>,
        <span class="string">"severity"</span>: <span class="string">"high"</span>,
        <span class="string">"description"</span>: <span class="string">"Subscription renews automatically..."</span>,
        <span class="string">"quote"</span>: <span class="string">"..."</span>
      }
    ],
    <span class="string">"summary"</span>: <span class="string">"This service has several concerning..."</span>
  },
  <span class="string">"usage"</span>: {
    <span class="string">"remaining"</span>: 195,
    <span class="string">"resetAt"</span>: <span class="string">"2024-02-01T00:00:00Z"</span>
  }
}</code>
          </div>
        </div>
      </div>
    </div>
    
    <script src="api-access.js"></script>
  </body>
</html>
